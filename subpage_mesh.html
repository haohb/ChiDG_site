<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.10"/>
<title>ChiDG: Overview</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<!-- BEGIN Google Analytics -->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-80530851-1', 'auto');
  ga(function(tracker) {
      var location = tracker.get('location');
      console.log(location);
  });
  ga(function(tracker) {
      var hostname = tracker.get('hostname');
      console.log(hostname);
  });
  ga(function(tracker) {
      var path = tracker.get('path');
      console.log(path);
  });
  ga('set', 'location', 'http://nwukie.github.io/ChiDG_site');
  ga('set', 'hostname', 'nwukie.github.io');
  ga('set', 'path', '/ChiDG_site');
  ga('send', 'pageview');
</script>
<!-- END Google Analytics -->
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/SVG"],
});
</script><script src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ChiDG
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">A Chimera-based, discontinuous Galerkin solver</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.10 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('subpage_mesh.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Mesh data structures </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The mesh_t data structure contains an entire geometry description for a single mesh domain. This exists as an array of element_t types, an array of face_t types, and a chimera_t instance. An element_t exists for every element in the mesh_t domain. For a given element_t, a face_t instance exists for each face.</p>
<div class="image">
<img src="d_mesh_exploded.png" alt="d_mesh_exploded.png"/>
</div>
<div class="image">
<img src="d_mesh_arrays.png" alt="d_mesh_arrays.png"/>
</div>
<h1><a class="anchor" id="s_element"></a>
Elements</h1>
<p>An element_t instance contains information needed by the framework and also general information that could be useful to developers. This includes: </p><pre class="fragment">        elem_pts(:)   An array of points defining element in real space(cartesian, cylindrical, etc.)
        quad_pts(:)   An array of points defining the location of each volume quadrature node in real space.
        metric(3,3,:) An array, defining for each quadrature point, a matrix of element metric values.
        jinv(:)       An array of inverse element jacobian values at each volume quadrature node.
        dtdx(:,:)     An array of derivatives of the basis functions with respect to real coordinates at volume quadrature nodes.</pre><div class="image">
<img src="d__element.png" alt="d__element.png"/>
</div>
<h2><a class="anchor" id="s_element_metrics"></a>
Metric terms</h2>
<p>The metric terms are defined at each quadrature point in the <code>metric(:,:,:)</code> component of a given <code>element_t</code>. To access the matrix of metric components for a given quadrature node <code>igq</code>, the component can be used as</p>
<pre class="fragment">    metric(:,:,igq) 
</pre><p>This returns the metric components at the quadrature node in a 3x3 matrix as:</p>
<p>\( \begin{pmatrix} \xi_x \quad \xi_y \quad \xi_z \\ \eta_x \quad \eta_y \quad \eta_z \\ \zeta_x \quad \zeta_y \quad \zeta_z \end{pmatrix} \)</p>
<p>Alternatively, a given metric term can be accessed for the set of quadrature nodes as</p>
<pre class="fragment">    metric(1,1,:)
</pre><p>which would return a 1D array of values for \( \xi_x \) corresponding to each volume quadrature node.</p>
<p>The inverse element jacobian terms <code>jinv(:)</code> are defined at each quadrature node as</p>
<p>\( J^{-1} = ( x_\xi \xi_x + x_\eta \eta_x + x_\zeta \zeta_x ) \)</p>
<h2><a class="anchor" id="s_element_derivatives"></a>
Derivatives</h2>
<p>The derivatives of basis functions with respect to the computational coordinates on a reference element are already defined in a quadrature instance associated with an element in the component <code>element_t</code>%<code>gq</code>%<code>vol</code>. For example, the component <code>element_t</code>%<code>gq</code>%<code>vol</code>%<code>ddxi</code> gives:</p>
<p class="formulaDsp">
\[ \frac{\partial \psi_{igq, imode}}{\partial \xi} = \begin{pmatrix} \frac{\partial \psi_{1,1}}{\partial \xi} &amp; \frac{\partial \psi_{1,2}}{\partial \xi} &amp; \cdots &amp; \frac{\partial \psi_{1,N}}{\partial \xi} \\ \frac{\partial \psi_{2,1}}{\partial \xi} &amp; \frac{\partial \psi_{2,2}}{\partial \xi} &amp; \cdots &amp; \frac{\partial \psi_{2,N}}{\partial \xi} \\ \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\ \frac{\partial \psi_{{ngq},1}}{\partial \xi} &amp; \frac{\partial \psi_{{ngq},2}}{\partial \xi} &amp; \cdots &amp; \frac{\partial \psi_{{ngq},N}}{\partial \xi} \\ \end{pmatrix} \]
</p>
<p>Derivatives in real space coordinates in an <code>element_t</code> can be computed using <code>dtdx(:,:)</code> components. The derivatives of basis functions with respect to real coordinates( \((x,y,z)\), \((r,\theta,z)\) ) are specific to each <code>element_t</code> and these derivatives can be accessed in the <code>dtdx</code>, <code>dtdy</code>, <code>dtdz</code> components. The <code>element_t</code>%<code>dtdx</code> component for example gives</p>
<p class="formulaDsp">
\[ \frac{\partial \psi_{igq, imode}}{\partial x} = \begin{pmatrix} \frac{\partial \psi_{1,1}}{\partial x} &amp; \frac{\partial \psi_{1,2}}{\partial x} &amp; \cdots &amp; \frac{\partial \psi_{1,N}}{\partial x} \\ \frac{\partial \psi_{2,1}}{\partial x} &amp; \frac{\partial \psi_{2,2}}{\partial x} &amp; \cdots &amp; \frac{\partial \psi_{2,N}}{\partial x} \\ \vdots &amp; \vdots &amp; \vdots &amp; \vdots \\ \frac{\partial \psi_{{ngq},1}}{\partial x} &amp; \frac{\partial \psi_{{ngq},2}}{\partial x} &amp; \cdots &amp; \frac{\partial \psi_{{ngq},N}}{\partial x} \\ \end{pmatrix} \]
</p>
<h2><a class="anchor" id="s_element_quadrature"></a>
Quadrature</h2>
<p>Each <code>element_t</code> has quadrature instances associated with it that depend on the number of modes in the polynomial expansion being integrated, and also the number of quadrature points being used to perform the integration of a given mode. These rules are defined on a reference element so a given <code>element_t</code> contains pointers <code>gq</code> and <code>gqmesh</code> to quadrature instances that correspond to the solution and coordinate polynomial expansions respectively.</p>
<p>See <a class="el" href="subpage_integration.html">Integration</a></p>
<h1><a class="anchor" id="s_face"></a>
Faces</h1>
<div class="image">
<img src="d__face.png" alt="d__face.png"/>
</div>
<div class="image">
<img src="d__reference_element.png" alt="d__reference_element.png"/>
</div>
<h2><a class="anchor" id="s_face_metrics"></a>
Face metrics</h2>
<p>Metric terms for <code>face_t</code> data structure are defined exactly the same as for the <code>element_t</code> data structure. The difference is that the <code>metric</code> and <code>jinv</code> components of <code>face_t</code> return values for boundary quadrature nodes. This contrasts the <code>element_t</code> structure, which returns values for volume quadrature nodes.</p>
<h2><a class="anchor" id="s_face_normals"></a>
Face normals</h2>
<p class="formulaDsp">
\[ \vec{x} = [x, y, z] \quad \vec{\xi} = [\xi, \eta, \zeta] \]
</p>
<p>Face normal vectors are stored for each face quadrature node. The component <code>norm</code> is the face normal vector with respect to computational coordinates on a reference element ( \( \xi, \eta, \zeta \)) as</p>
<p class="formulaDsp">
\[ \vec{n}_{\xi_k} = \frac{\partial \vec{x}}{\partial \xi_i} \times \frac{\partial \vec{x}}{\partial \xi_j} \]
</p>
<p>where \( \xi_i \) and \( \xi_j \) are the in-plane coordinates of face \( \xi_k \). In this way, the normal vectors for \( \xi\), \( \eta\), and \( \zeta\) faces are defined respectively as</p>
<p class="formulaDsp">
\[ \vec{n}_\xi = \frac{\partial \vec{x}}{\partial \eta} \times \frac{\partial \vec{x}}{\partial \zeta} = [ y_\eta z_\zeta - y_\zeta z_\eta, \quad x_\zeta z_\eta - x_\eta z_\zeta, \quad x_\eta y_\zeta - x_\zeta y_\eta] = [ \xi_x, \quad \xi_y, \quad \xi_z ] \]
</p>
<p class="formulaDsp">
\[ \vec{n}_\eta = \frac{\partial \vec{x}}{\partial \zeta} \times \frac{\partial \vec{x}}{\partial \xi} = [ y_\zeta z_\xi - y_\xi z_\zeta, \quad x_\xi z_\zeta - x_\zeta z_\xi, \quad x_\zeta y_\xi - x_\xi y_\zeta ] = [ \eta_x, \quad \eta_y, \quad \eta_z ] \]
</p>
<p class="formulaDsp">
\[ \vec{n}_\zeta = \frac{\partial \vec{x}}{\partial \xi} \times \frac{\partial \vec{x}}{\partial \eta} = [ y_\xi z_\eta - y_\eta z_\xi, \quad x_\eta z_\xi - x_\xi z_\eta, \quad x_\xi y_\eta - x_\eta y_\xi] = [ \zeta_x, \quad \zeta_y, \quad \zeta_z ] \]
</p>
<p>Applying the above formula to element faces produces normal vectors that are inward facing for \( \xi=-1 \) faces and outward facing for \( \xi=1 \) faces. Inward facing vectors are negated so that all resultant normal vectors in the <code>norm</code> component are outward facing. This applies to \( \eta \) and \( \zeta \) faces as well.</p>
<p>Unit normal vectors can be accessed in the <code>unorm</code> component and are computed as</p>
<p class="formulaDsp">
\[ \hat{n}_{\xi_i} = \frac{\vec{n}_{\xi_i}}{||\vec{n}_{\xi_i}||_2} \]
</p>
<h1><a class="anchor" id="s_chimera"></a>
Chimera Interfaces</h1>
<p>Each <code>mesh_t</code> instance contains a <code>mesh</code>%<code>chimera</code> component that holds all information regarding chimera communication for that particular mesh block. This takes the form of a <code>chimera_receiver_t</code> and <code>chimera_donor_t</code> components. Currently, only the <code>chimera_receiver_t</code> is utilized. <code>chimera_donor_t</code> will be used to facilitate communication between processors for parallel code execution.</p>
<div class="image">
<img src="d__chimera_receiver.png" alt="d__chimera_receiver.png"/>
</div>
<p>In a given <code>mesh_t</code> block, every face that gets information from a separate block is designated as a CHIMERA face, it is assigned an integer ID <code>face</code>%<code>ChiID</code>, and it gets an entry in the <code>mesh</code>%<code>chimera</code>%<code>recv</code>%<code>data</code> component. It can be accessed as</p>
<div class="fragment"><div class="line">mesh%<a class="code" href="namespacemod__constants.html#a892506573bcde8e74e131d5de7cc14d6">chimera</a>%recv%<a class="code" href="namespacetype__ivector.html#a0ba0ca72e7ea265dd364300e0fa67679">data</a>(ChiID)   </div>
</div><!-- fragment --><h2><a class="anchor" id="s_chimera_example"></a>
Example</h2>
<p>Consider an example with two mesh domains, as shown below. <code>mesh(1)</code> contains four elements. <code>mesh(2)</code> contains eight elements. <code>mesh(1)</code> overlaps with <code>mesh(2)</code>. In particular, the top faces of elements E3 and E4 lie inside <code>mesh(2)</code>. These faces are designated as CHIMERA faces and are given a mesh-global chimera ID. The top face of E3 is given the ID ChiID=1 and the top face of E4 is given the ID ChiID=2.</p>
<div class="image">
<img src="d__chimera_demo_a.png" alt="d__chimera_demo_a.png"/>
</div>
<p>Each CHIMERA face has its own set of chimera information, which can be accessed via <code>mesh</code>%<code>chimera</code>%<code>recv</code>%<code>data(ChiID)</code>. This is shown below for the two faces in this example.</p>
<div class="image">
<img src="d__chimera_demo_b.png" alt="d__chimera_demo_b.png"/>
</div>
 </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sat Jul 9 2016 13:59:23 for ChiDG by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.10 </li>
  </ul>
</div>
</body>
</html>
